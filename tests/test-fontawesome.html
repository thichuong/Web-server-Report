<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Font Awesome Test trong Iframe</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" crossorigin="anonymous">
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .test-section {
            margin: 20px 0;
            padding: 20px;
            border: 2px solid #ddd;
            border-radius: 8px;
        }
        
        .icon-test {
            display: inline-block;
            margin: 10px;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        
        .icon-large {
            font-size: 2em;
        }
        
        iframe {
            width: 100%;
            height: 400px;
            border: 2px solid #333;
            margin: 20px 0;
        }
        
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
        }
        
        .success { background-color: #d4edda; color: #155724; }
        .warning { background-color: #fff3cd; color: #856404; }
        .error { background-color: #f8d7da; color: #721c24; }
    </style>
</head>
<body>
    <h1>üß™ Font Awesome Test trong Iframe</h1>
    
    <div class="test-section">
        <h2>üìã Test 1: Font Awesome tr·ª±c ti·∫øp tr√™n parent page</h2>
        <div class="icon-test">
            <i class="fas fa-chart-line icon-large"></i> Chart Line
        </div>
        <div class="icon-test">
            <i class="fas fa-coins icon-large"></i> Coins
        </div>
        <div class="icon-test">
            <i class="fas fa-arrow-up icon-large"></i> Arrow Up
        </div>
        <div class="icon-test">
            <i class="fas fa-info-circle icon-large"></i> Info
        </div>
        <div id="parent-status" class="status"></div>
    </div>

    <div class="test-section">
        <h2>üñºÔ∏è Test 2: Font Awesome trong Iframe</h2>
        <iframe id="test-iframe" srcdoc='
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Iframe Test</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" crossorigin="anonymous">
    <style>
        body {
            padding: 20px;
            font-family: Arial, sans-serif;
        }
        .icon-test {
            display: inline-block;
            margin: 10px;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        .icon-large {
            font-size: 2em;
        }
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
        }
        .success { background-color: #d4edda; color: #155724; }
        .warning { background-color: #fff3cd; color: #856404; }
        .error { background-color: #f8d7da; color: #721c24; }
        
        /* Fallback styles */
        .fa-fallback .fa-chart-line:before { content: "üìà"; }
        .fa-fallback .fa-coins:before { content: "ü™ô"; }
        .fa-fallback .fa-arrow-up:before { content: "‚Üë"; }
        .fa-fallback .fa-info-circle:before { content: "‚ÑπÔ∏è"; }
    </style>
</head>
<body>
    <h3>Font Awesome Icons trong Iframe:</h3>
    <div class="icon-test">
        <i class="fas fa-chart-line icon-large"></i> Chart Line
    </div>
    <div class="icon-test">
        <i class="fas fa-coins icon-large"></i> Coins  
    </div>
    <div class="icon-test">
        <i class="fas fa-arrow-up icon-large"></i> Arrow Up
    </div>
    <div class="icon-test">
        <i class="fas fa-info-circle icon-large"></i> Info
    </div>
    
    <div id="iframe-status" class="status"></div>
    
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            setTimeout(() => {
                const testIcon = document.createElement("i");
                testIcon.className = "fas fa-test-icon";
                testIcon.style.display = "none";
                document.body.appendChild(testIcon);
                
                const computedStyle = window.getComputedStyle(testIcon, ":before");
                const fontFamily = computedStyle.getPropertyValue("font-family");
                
                const statusDiv = document.getElementById("iframe-status");
                
                if (fontFamily.includes("Font Awesome")) {
                    statusDiv.className = "status success";
                    statusDiv.textContent = "‚úÖ Font Awesome loaded successfully in iframe!";
                    console.log("‚úÖ Iframe: Font Awesome loaded successfully");
                } else {
                    statusDiv.className = "status warning";  
                    statusDiv.textContent = "‚ö†Ô∏è Font Awesome failed to load in iframe, using fallback icons";
                    document.body.classList.add("fa-fallback");
                    console.warn("‚ö†Ô∏è Iframe: Font Awesome failed to load");
                }
                
                document.body.removeChild(testIcon);
                
                // Notify parent
                if (window.parent && window.parent !== window) {
                    window.parent.postMessage({
                        type: "iframe-fa-status",
                        loaded: fontFamily.includes("Font Awesome")
                    }, "*");
                }
            }, 1000);
        });
    </script>
</body>
</html>
        '></iframe>
        <div id="iframe-status-external" class="status"></div>
    </div>

    <div class="test-section">
        <h2>üåê Test 3: CDN Connectivity Test</h2>
        <div id="cdn-test-status" class="status">ƒêang test...</div>
        <button onclick="testCDN()">üîÑ Test l·∫°i CDN</button>
    </div>

    <script>
        // Test Font Awesome loading on parent page
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(() => {
                const testIcon = document.createElement('i');
                testIcon.className = 'fas fa-test-icon';
                testIcon.style.display = 'none';
                document.body.appendChild(testIcon);
                
                const computedStyle = window.getComputedStyle(testIcon, ':before');
                const fontFamily = computedStyle.getPropertyValue('font-family');
                
                const statusDiv = document.getElementById('parent-status');
                
                if (fontFamily.includes('Font Awesome')) {
                    statusDiv.className = 'status success';
                    statusDiv.textContent = '‚úÖ Font Awesome loaded successfully on parent page!';
                } else {
                    statusDiv.className = 'status error';
                    statusDiv.textContent = '‚ùå Font Awesome failed to load on parent page';
                }
                
                document.body.removeChild(testIcon);
            }, 500);
        });

        // Listen for messages from iframe
        window.addEventListener('message', function(event) {
            if (event.data && event.data.type === 'iframe-fa-status') {
                const statusDiv = document.getElementById('iframe-status-external');
                if (event.data.loaded) {
                    statusDiv.className = 'status success';
                    statusDiv.textContent = '‚úÖ Iframe confirmed: Font Awesome is working!';
                } else {
                    statusDiv.className = 'status warning';
                    statusDiv.textContent = '‚ö†Ô∏è Iframe confirmed: Font Awesome failed, using fallback';
                }
            }
        });

        // Test CDN connectivity
        function testCDN() {
            const statusDiv = document.getElementById('cdn-test-status');
            statusDiv.className = 'status';
            statusDiv.textContent = 'ƒêang test CDN connectivity...';

            const link = document.createElement('link');
            link.rel = 'stylesheet';
            link.href = 'https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css?t=' + Date.now();
            link.crossOrigin = 'anonymous';
            
            link.onload = function() {
                statusDiv.className = 'status success';
                statusDiv.textContent = '‚úÖ CDN accessible - Font Awesome CSS loaded successfully';
            };
            
            link.onerror = function() {
                statusDiv.className = 'status error';
                statusDiv.textContent = '‚ùå CDN inaccessible - Cannot load Font Awesome CSS';
            };
            
            document.head.appendChild(link);
            
            // Remove after test
            setTimeout(() => {
                document.head.removeChild(link);
            }, 5000);
        }

        // Auto-run CDN test on page load
        setTimeout(testCDN, 1000);
    </script>
</body>
</html>
